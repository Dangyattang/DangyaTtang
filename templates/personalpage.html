<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>당신은 야식이 땡긴다</title>
    <!-- <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.3/dist/tailwind.min.css" rel="stylesheet"> -->
    <!-- 폰트 헤더 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Gasoek+One&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      crossorigin="anonymous"
    ></script>
    <style>
      #returnhome {
        position: fixed;
        bottom: 60px;
        right: 60px;
      }
      .challange {
        margin: 10px auto 30px auto;
        width: 800px;
        text-align: center;

        border: 3px solid black;
        border-radius: 5px;

        padding: 5px;
      }
      .gasoek-one-regular {
        font-family: "Gasoek One", sans-serif;
        font-weight: 400;
        font-style: normal;
        position: relative;
        padding-right: 0px;
        padding-left: 0;
        top: -5px;
      }

      .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        padding: 10px;
      }

      .wrap {
        width: 800px;
        margin: 0 auto; /* 가로 중앙 정렬 */
      }

      .icon svg {
        width: 50px;
        height: 50px;
        margin: 10px;
      }
      .btngroup {
        display: flex;
        flex-wrap: nowrap; /* 버튼들이 한 줄에 맞지 않으면 자동으로 줄바꿈 */
        width: 800px; /* 너비를 800px로 설정 */
        margin: 0 auto; /* 가로 중앙 정렬 */
        justify-content: space-evenly; /* 버튼들 간에 균등한 간격을 설정 */
      }
      .btngroup button {
        width: 100px;
      }

      .max-w-7xl {
        max-width: 800px;
      }
    </style>
    <script>
      const API_BASE_URL = "http://127.0.0.1:5000"; // API 경로 (5000 포트)

      $(document).ready(function () {
        $("#prevrdersBox").html("");
        showprevorder();
        $("#membersBox").html("");
        showmem();
      });

      //이전 주문들 보여주기
      function showprevorder() {
        // for (let i = 0; i < 5; i++) {
        //   makeprevorder();
        // }
        $.ajax({
          type: "GET",
          url: `${API_BASE_URL}/orders/prev`,
          data: {},
          success: function (response) {
            let prevorders = response["prevorders"];
            console.log(prevorders);
            for (let i = 0; i < prevorders.length; i++) {
              makeprevorder(
                prevorders[i]["_id"],
                prevorders[i]["food_category"],
                prevorders[i]["menu_details"],
                prevorders[i]["participants"],
                prevorders[i]["max_participants"],
                prevorders[i]["expires_at"],
                prevorders[i]["open_chat_url"]
              );
            }
          },
        });
      }
      function insertphonenum(participants) {
        $.ajax({
          type: "GET",
          url: `${API_BASE_URL}/order/prev/phonenum`,
          data: {},
          success: function (response) {
            let phonenum = response["phone"];
            console.log(phonenum);
            $("#phoneDisplay").html(`<p>${username} : ${response.phone}</p>`);
          },
        });
      }
      function makeprevorder(
        _id,
        food_category,
        menu_details,
        participants,
        max_participants,
        expires_at,
        open_chat_url
      ) {
        const strcatagory = food_category[0];
        for (let i = 1; i < food_category.length; i++) {
          strcatagory += " + ";
          strcatagory += food_category[i];
        }
        const strmemberbtn = "";
        for (let i = 0; i < participants.length; i++) {
          strmemberbtn += `<span class="flex items-center gap-3" id="memsBox1">
      <div
        class="p-1 rounded-full bg-gradient-to-br from-pink-500 to-orange-500"
      >
        <div class="p-0.5 rounded-full bg-white" onclick="insertphonenum('${participants[i]}')">
          <div>${participants[i]}</div>
        </div>
      </div>
    </span>`;
        }

        let tempHtml = `<!-- Card -->
          <div
            id="${_id}"
            class="group bg-white dark:bg-[#1E2028] rounded-md overflow-hidden border border-gray-100 dark:border-gray-800 hover:border-indigo-500 dark:hover:border-indigo-500 transition-colors"
          >
            <div class="p-4" style="text-align: left">
              <!-- Title -->
              <h3
                class="text-lg font-medium text-black dark:text-white mt-2 group-hover:text-indigo-500 transition-colors line-clamp-2"
              >
              ${strcatagory}
              </h3>

              <!-- Meta Information -->
              <span class="text-xs text-gray-500 dark:text-gray-400">
                오픈카카오톡 URL:
                <a href="${open_chat_url}" style="color: blue"
                  >${open_chat_url}</a
                ></span
              >
              <div class="mt-1">
                <span class="text-xs text-gray-500 dark:text-gray-400"
                  >${menu_details}</span
                >
              </div>
              <span>
                ${strmemberbtn}
                <span id="phoneDisplay" style="margin-top: 10px;"></span>
                </span>
            </div>
          </div>`;
        $("#prevrdersBox").append(tempHtml);
      }
      //   function showmember() {
      //     for (let i = 0; i < 5; i++) {
      //       makemember();
      //     }
      //     $.ajax({
      //       type: "GET",
      //       url: "/ordermembers",
      //       data: {},
      //       success: function (response) {
      //         let ordermembers = response["ordermembers"];
      //         console.log(ordermembers);
      //         for (let i = 0; i < ordermembers.length; i++) {
      //           makemember(
      //             ordermembers[i]["orderid"],
      //             ordermembers[i]["menucatagory"],

      //           );
      //         }
      //       },
      //     });
      //   }
      //   function makemember() {
      //     let tempHtml = `<div
      //               class="p-1 rounded-full bg-gradient-to-br from-pink-500 to-orange-500"
      //             >
      //               <div class="p-0.5 rounded-full bg-white">
      //                 <div>닉네임</div>
      //               </div>
      //             </div>`;
      //     $("#membersBox").append(tempHtml);
      //   }

      function showOrder() {
        $.ajax({
          type: "GET",
          url: `${API_BASE_URL}/currentorder`,
          data: {},
          success: function (response) {
            let currentorder = response["currentorder"];
            console.log(currentorder);
            makeOrder(
              currentorder[i]["_id"],
              currentorder[i]["food_category"],
              currentorder[i]["menu_details"],
              currentorder[i]["time"],
              currentorder[i]["participants"],
              currentorder[i]["max_participants"]
            );
          },
        });
      }
      function makeOrder(
        _id,
        food_category,
        menu_details,
        time,
        participants,
        max_participants
      ) {
        const strcatagory = food_category[0];
        for (let i = 1; i < food_category.length; i++) {
          strcatagory += " + ";
          strcatagory += food_category[i];
        }
        let tempHtml = `<!-- Card 1 -->
    <div
      id="${_id}"
      class="group bg-white dark:bg-[#1E2028] rounded-md overflow-hidden border border-gray-100 dark:border-gray-800 hover:border-indigo-500 dark:hover:border-indigo-500 transition-colors"

    >
      <div class="p-4">
        <!-- Title -->
        <h3
          class="text-lg font-medium text-black dark:text-white mt-2 group-hover:text-indigo-500 transition-colors line-clamp-2"
        >
          ${strcatagory}
        </h3>

        <!-- Meta Information -->
        <div class="flex flex-wrap items-center gap-4 mt-4">
            <span class="text-xs text-gray-500 dark:text-gray-400"> 남은시간 : ${time}</span>
            <span class="text-xs text-gray-500 dark:text-gray-400"> 필요인원 : ${numpeople}/${numpeoplesize}</span>
        </div>
        <div class="mt-1">
            <span class="text-xs text-gray-500 dark:text-gray-400">${menudetail}</span>
        </div>
        <div class="mt-2 flex justify-end">
            <button class="px-4 py-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors">
                참가
            </button>
        </div>
        

        </div>
      </div>`;
        $("#currentorder").append(tempHtml);
      }
    </script>
  </head>
  <body>
    <div class="container">
      <div style="text-align: left">
        <span
          class="gasoek-one-regular"
          style="color: red; font-size: 40px; display: inline"
          >당</span
        ><span
          class="gasoek-one-regular"
          style="font-size: 40px; display: inline"
          >신은</span
        >
        <span
          class="gasoek-one-regular"
          style="color: red; font-size: 40px; display: inline"
          >야</span
        ><span
          class="gasoek-one-regular"
          style="font-size: 40px; display: inline"
          >식이</span
        >
        <span
          class="gasoek-one-regular"
          style="color: red; font-size: 40px; display: inline"
          >떙</span
        ><span
          class="gasoek-one-regular"
          style="font-size: 40px; display: inline"
          >긴다</span
        >
      </div>

      <!-- 오른쪽 정렬 -->
    </div>
    <!-- Minimal Blog Cards Grid -->
    <div class="max-w-7xl w-full mx-auto p-4" style="max-width: 800px">
      <div
        class="p-0.5 rounded-xl bg-gradient-to-r from-green-400 to-green-600"
      >
        <div
          class="p-0.5 rounded-xl bg-white"
          style="text-align: center; padding: 10px 5px 10px 5px"
        >
          <span class="gasoek-one-regular" style="font-size: 30px"
            >현재 참여 신청한 팀 주문
          </span>
          <div id="currentorder">
            <!-- Card 1 -->
            <div
              id="orderid1"
              class="group bg-white dark:bg-[#1E2028] rounded-md overflow-hidden border border-gray-100 dark:border-gray-800 hover:border-indigo-500 dark:hover:border-indigo-500 transition-colors"
            >
              <div class="p-4" style="text-align: left">
                <!-- Title -->
                <h3
                  class="text-lg font-medium text-black dark:text-white mt-2 group-hover:text-indigo-500 transition-colors line-clamp-2"
                >
                  치킨 + 피자
                </h3>

                <!-- Meta Information -->
                <div class="flex flex-wrap items-center gap-4 mt-4">
                  <span class="text-xs text-gray-500 dark:text-gray-400">
                    남은시간 : 3분</span
                  >
                  <span class="text-xs text-gray-500 dark:text-gray-400">
                    필요인원 : 2/5</span
                  >
                </div>
                <div class="mt-1">
                  <span class="text-xs text-gray-500 dark:text-gray-400"
                    >#허니콤보 #하와이안피자</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <br />
      <div
        class="p-0.5 rounded-xl bg-gradient-to-r from-orange-500 via-red-500 to-purple-500"
      >
        <div
          class="p-0.5 rounded-xl bg-white"
          style="text-align: center; padding: 10px 5px 10px 5px"
        >
          <span class="gasoek-one-regular" style="font-size: 30px"
            >참여 확정된 팀 주문</span
          >
          <div id="prevrdersBox">
            <!-- Card 1 -->
            <div
              id="eatingorder"
              class="group bg-white dark:bg-[#1E2028] rounded-md overflow-hidden border border-gray-100 dark:border-gray-800 hover:border-indigo-500 dark:hover:border-indigo-500 transition-colors"
            >
              <div class="p-4" style="text-align: left">
                <!-- Title -->
                <h3
                  class="text-lg font-medium text-black dark:text-white mt-2 group-hover:text-indigo-500 transition-colors line-clamp-2"
                >
                  치킨 + 피자
                </h3>

                <!-- Meta Information -->
                <span class="text-xs text-gray-500 dark:text-gray-400">
                  오픈카카오톡 URL:
                  <a
                    href="https://open.kakao.com/o/gZpJUelh"
                    style="color: blue"
                    >https://open.kakao.com/o/gZpJUelh</a
                  ></span
                >
                <div class="mt-1">
                  <span class="text-xs text-gray-500 dark:text-gray-400"
                    >#허니콤보 #하와이안피자</span
                  >
                </div>
                <span>
                  <span class="flex items-center gap-3" id="membersBox1">
                    <div
                      class="p-1 rounded-full bg-gradient-to-br from-pink-500 to-orange-500"
                    >
                      <div class="p-0.5 rounded-full bg-white">
                        <div>닉네임</div>
                      </div>
                    </div>
                    <!-- <div
                  class="p-1 rounded-full bg-gradient-to-br from-pink-500 to-orange-500"
                >
                  <div class="p-0.5 rounded-full bg-white">
                    <img
                      src="https://cdn.startupful.io/img/app_logo/no_img.png"
                      alt="Diagonal Gradient"
                      class="w-10 h-10 rounded-full object-cover"
                    />
                  </div>
                </div> -->
                  </span>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div style="text-align: right" id="returnhome">
      <button
        data-modal-target="crud-modal"
        data-modal-toggle="crud-modal"
        class="px-6 py-2.5 border-2 border-red-500 text-red-500 rounded-lg hover:bg-red-50 transition-colors"
        onclick="location.href='index.html'"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="size-8"
        >
          <path
            fill-rule="evenodd"
            d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-4.28 9.22a.75.75 0 0 0 0 1.06l3 3a.75.75 0 1 0 1.06-1.06l-1.72-1.72h5.69a.75.75 0 0 0 0-1.5h-5.69l1.72-1.72a.75.75 0 0 0-1.06-1.06l-3 3Z"
            clip-rule="evenodd"
          />
        </svg>
      </button>
    </div>
  </body>
</html>
